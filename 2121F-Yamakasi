//https://codeforces.com/problemset/problem/2121/F
#include <iostream>
#include <map>
#include <cmath>
#include <unordered_map>
#include <bits/stdc++.h>
#include <queue>
#include <algorithm>
using namespace std;
#define ll long long
ll answer (vector <ll>v ,ll s ){
ll n =v.size();
vector <ll> prefix(n+1,0);
for (int i=0;i<n ;i++){
    prefix [i+1]=prefix[i]+v[i];
}
map <ll ,ll > m ;
m[0]++;
ll res= 0;
for (int i=1;i<=n;i++){
    res+=m [prefix[i]-s];
    m[prefix[i]]++;
 
}
return res ;
}
void solve (){
    ll n ,s,x;
    cin >> n>>s>>x ;
    vector <ll> vec(n) ;
    for (int i=0;i<n ;i++)cin >> vec[i];
    vector <ll>v ;
    ll ans =0;
    for (int i=0;i<n ;i++){
        if (vec[i]>x){
        ans +=answer(v,s );
        v.clear ();
        }else {
            v.push_back(vec[i]);
        }
    }
    ans +=answer(v,s );
        v.clear ();
    for (int i=0;i<n ;i++){
        if (vec[i]>=x){
        ans -=answer(v,s );
        v.clear ();
        }else {
            v.push_back(vec[i]);
        }}
    
    ans -=answer(v,s );
        v.clear ();  
        cout << ans << endl ;  
}
int main() {
ios::sync_with_stdio(false);
cin.tie(nullptr);
cout.tie(nullptr);
int t ;
cin >> t;
while (t--){
    solve ();
}
    return 0;
}
 
